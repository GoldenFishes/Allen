import{EVENT_CODE as e,ElButton as t,ElIcon as n,ElInput as r,ElMessage as i,ElTooltip as a,Fragment as o,TinyColor as s,Transition as c,TypeComponentsMap as l,__plugin_vue_export_helper_default as u,_export_sfc as d,addClass as f,arrow_down_default as p,arrow_left_default as m,arrow_right_default as h,attachMasLinkDelegation as g,bell_default as _,bindHumanAgent as v,buildProps as y,close_default as b,computed as x,createBaseVNode as S,createBlock as C,createCommentVNode as w,createElementBlock as T,createTextVNode as E,createVNode as D,debugWarn as O,defineComponent as k,definePropType as A,document_default as j,flattedChildren as M,getCurrentInstance as ee,getStatesApi as N,h as P,hasClass as te,iconPropType as F,inject as ne,isArray as re,isClient as ie,isElement as ae,isFunction as oe,isNil_default as se,isObject as I,isPropAbsent as ce,isString as L,isUndefined as le,isVNode as ue,lib_default as de,list_default as fe,mergeProps as pe,minus_default as me,more_default as he,mutable as ge,nextTick as _e,normalizeClass as R,normalizeStyle as z,onBeforeUnmount as ve,onMounted as B,onUnmounted as ye,openBlock as V,operation_default as be,provide as xe,reactive as Se,ref as H,removeClass as Ce,render as we,renderList as U,renderSlot as W,resolveComponent as Te,resolveDirective as Ee,resolveDynamicComponent as G,throwError as De,tickets_default as Oe,toDisplayString as K,toHandlers as ke,toRef as Ae,transformMasLinkNodes as je,triggerEvent as Me,unref as q,useEventListener as Ne,useGlobalComponentSettings as Pe,useMasStore as Fe,useModalMenuIntegration as Ie,useModalStore as Le,useNamespace as J,useResizeObserver as Re,useRoute as ze,useRouter as Be,useTimeoutFn as Ve,user_default as He,vShow as Ue,watch as Y,watchEffect as We,withCtx as X,withDirectives as Z,withInstall as Ge,withInstallFunction as Ke,withModifiers as qe,withNoopInstall as Je}from"./index-DLg66vRi.js";const Q=new Map;if(ie){let e;document.addEventListener(`mousedown`,t=>e=t),document.addEventListener(`mouseup`,t=>{if(e){for(let n of Q.values())for(let{documentHandler:r}of n)r(t,e);e=void 0}})}function Ye(e,t){let n=[];return re(t.arg)?n=t.arg:ae(t.arg)&&n.push(t.arg),function(r,i){let a=t.instance.popperRef,o=r.target,s=i?.target,c=!t||!t.instance,l=!o||!s,u=e.contains(o)||e.contains(s),d=e===o,f=n.length&&n.some(e=>e?.contains(o))||n.length&&n.includes(s),p=a&&(a.contains(o)||a.contains(s));c||l||u||d||f||p||t.value(r,i)}}const Xe={beforeMount(e,t){Q.has(e)||Q.set(e,[]),Q.get(e).push({documentHandler:Ye(e,t),bindingFn:t.value})},updated(e,t){Q.has(e)||Q.set(e,[]);let n=Q.get(e),r=n.findIndex(e=>e.bindingFn===t.oldValue),i={documentHandler:Ye(e,t),bindingFn:t.value};r>=0?n.splice(r,1,i):n.push(i)},unmounted(e){Q.delete(e)}},Ze=k({name:`ElCollapseTransition`}),Qe=k({...Ze,setup(e){let t=J(`collapse-transition`),n=e=>{e.style.maxHeight=``,e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},r={beforeEnter(e){e.dataset||={},e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height&&(e.dataset.elExistsHeight=e.style.height),e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){requestAnimationFrame(()=>{e.dataset.oldOverflow=e.style.overflow,e.dataset.elExistsHeight?e.style.maxHeight=e.dataset.elExistsHeight:e.scrollHeight===0?e.style.maxHeight=0:e.style.maxHeight=`${e.scrollHeight}px`,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow=`hidden`})},afterEnter(e){e.style.maxHeight=``,e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){n(e)},beforeLeave(e){e.dataset||={},e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow=`hidden`},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){n(e)},leaveCancelled(e){n(e)}};return(e,n)=>(V(),C(c,pe({name:q(t).b()},ke(r)),{default:X(()=>[W(e.$slots,`default`)]),_:3},16,[`name`]))}});var $e=d(Qe,[[`__file`,`collapse-transition.vue`]]);const et=Ge($e),tt=y({direction:{type:String,values:[`horizontal`,`vertical`],default:`horizontal`},contentPosition:{type:String,values:[`left`,`center`,`right`],default:`center`},borderStyle:{type:A(String),default:`solid`}}),nt=k({name:`ElDivider`}),rt=k({...nt,props:tt,setup(e){let t=e,n=J(`divider`),r=x(()=>n.cssVar({"border-style":t.borderStyle}));return(e,t)=>(V(),T(`div`,{class:R([q(n).b(),q(n).m(e.direction)]),style:z(q(r)),role:`separator`},[e.$slots.default&&e.direction!==`vertical`?(V(),T(`div`,{key:0,class:R([q(n).e(`text`),q(n).is(e.contentPosition)])},[W(e.$slots,`default`)],2)):w(`v-if`,!0)],6))}});var it=d(rt,[[`__file`,`divider.vue`]]);const at=Ge(it);var ot=class{constructor(e,t){this.parent=e,this.domNode=t,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll(`li`),this.addListeners()}gotoSubIndex(e){e===this.subMenuItems.length?e=0:e<0&&(e=this.subMenuItems.length-1),this.subMenuItems[e].focus(),this.subIndex=e}addListeners(){let t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,n=>{n.addEventListener(`keydown`,n=>{let r=!1;switch(n.code){case e.down:this.gotoSubIndex(this.subIndex+1),r=!0;break;case e.up:this.gotoSubIndex(this.subIndex-1),r=!0;break;case e.tab:Me(t,`mouseleave`);break;case e.enter:case e.numpadEnter:case e.space:r=!0,n.currentTarget.click();break}return r&&(n.preventDefault(),n.stopPropagation()),!1})})}},st=class{constructor(e,t){this.domNode=e,this.submenu=null,this.submenu=null,this.init(t)}init(e){this.domNode.setAttribute(`tabindex`,`0`);let t=this.domNode.querySelector(`.${e}-menu`);t&&(this.submenu=new ot(this,t)),this.addListeners()}addListeners(){this.domNode.addEventListener(`keydown`,t=>{let n=!1;switch(t.code){case e.down:Me(t.currentTarget,`mouseenter`),this.submenu&&this.submenu.gotoSubIndex(0),n=!0;break;case e.up:Me(t.currentTarget,`mouseenter`),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),n=!0;break;case e.tab:Me(t.currentTarget,`mouseleave`);break;case e.enter:case e.numpadEnter:case e.space:n=!0,t.currentTarget.click();break}n&&t.preventDefault()})}},ct=class{constructor(e,t){this.domNode=e,this.init(t)}init(e){let t=this.domNode.childNodes;Array.from(t).forEach(t=>{t.nodeType===1&&new st(t,e)})}};const lt=k({name:`ElMenuCollapseTransition`}),ut=k({...lt,setup(e){let t=J(`menu`),n={onBeforeEnter:e=>e.style.opacity=`0.2`,onEnter(e,n){f(e,`${t.namespace.value}-opacity-transition`),e.style.opacity=`1`,n()},onAfterEnter(e){Ce(e,`${t.namespace.value}-opacity-transition`),e.style.opacity=``},onBeforeLeave(e){e.dataset||={},te(e,t.m(`collapse`))?(Ce(e,t.m(`collapse`)),e.dataset.oldOverflow=e.style.overflow,e.dataset.scrollWidth=e.clientWidth.toString(),f(e,t.m(`collapse`))):(f(e,t.m(`collapse`)),e.dataset.oldOverflow=e.style.overflow,e.dataset.scrollWidth=e.clientWidth.toString(),Ce(e,t.m(`collapse`))),e.style.width=`${e.scrollWidth}px`,e.style.overflow=`hidden`},onLeave(e){f(e,`horizontal-collapse-transition`),e.style.width=`${e.dataset.scrollWidth}px`}};return(e,t)=>(V(),C(c,pe({mode:`out-in`},q(n)),{default:X(()=>[W(e.$slots,`default`)]),_:3},16))}});var dt=d(ut,[[`__file`,`menu-collapse-transition.vue`]]);function ft(e,t){let n=x(()=>{let n=e.parent,r=[t.value];for(;n.type.name!==`ElMenu`;)n.props.index&&r.unshift(n.props.index),n=n.parent;return r}),r=x(()=>{let t=e.parent;for(;t&&![`ElMenu`,`ElSubMenu`].includes(t.type.name);)t=t.parent;return t});return{parentMenu:r,indexPath:n}}function pt(e){let t=x(()=>{let t=e.backgroundColor;return t?new s(t).shade(20).toString():``});return t}const mt=(e,t)=>{let n=J(`menu`);return x(()=>n.cssVarBlock({"text-color":e.textColor||``,"hover-text-color":e.textColor||``,"bg-color":e.backgroundColor||``,"hover-bg-color":pt(e).value||``,"active-color":e.activeTextColor||``,level:`${t}`}))},ht=`rootMenu`,gt=`subMenu:`,_t=y({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:F},expandOpenIcon:{type:F},collapseCloseIcon:{type:F},collapseOpenIcon:{type:F}}),vt=`ElSubMenu`;var yt=k({name:vt,props:_t,setup(e,{slots:t,expose:r}){let i=ee(),{indexPath:s,parentMenu:c}=ft(i,x(()=>e.index)),l=J(`menu`),u=J(`sub-menu`),d=ne(ht);d||De(vt,`can not inject root menu`);let f=ne(`${gt}${c.value.uid}`);f||De(vt,`can not inject sub menu`);let m=H({}),g=H({}),_,v=H(!1),y=H(),b=H(),S=x(()=>A.value===`horizontal`&&w.value?`bottom-start`:`right-start`),C=x(()=>A.value===`horizontal`&&w.value||A.value===`vertical`&&!d.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?O.value?e.expandOpenIcon:e.expandCloseIcon:p:e.collapseCloseIcon&&e.collapseOpenIcon?O.value?e.collapseOpenIcon:e.collapseCloseIcon:h),w=x(()=>f.level===0),T=x(()=>{let t=e.teleported;return le(t)?w.value:t}),E=x(()=>d.props.collapse?`${l.namespace.value}-zoom-in-left`:`${l.namespace.value}-zoom-in-top`),D=x(()=>A.value===`horizontal`&&w.value?[`bottom-start`,`bottom-end`,`top-start`,`top-end`,`right-start`,`left-start`]:[`right-start`,`right`,`right-end`,`left-start`,`bottom-start`,`bottom-end`,`top-start`,`top-end`]),O=x(()=>d.openedMenus.includes(e.index)),k=x(()=>[...Object.values(m.value),...Object.values(g.value)].some(({active:e})=>e)),A=x(()=>d.props.mode),j=x(()=>d.props.persistent),M=Se({index:e.index,indexPath:s,active:k}),N=mt(d.props,f.level+1),te=x(()=>{var t;return(t=e.popperOffset)??d.props.popperOffset}),F=x(()=>{var t;return(t=e.popperClass)??d.props.popperClass}),re=x(()=>{var t;return(t=e.showTimeout)??d.props.showTimeout}),ie=x(()=>{var t;return(t=e.hideTimeout)??d.props.hideTimeout}),ae=()=>{var e,t,n;return(n=(t=(e=b.value)?.popperRef)?.popperInstanceRef)?.destroy()},oe=e=>{e||ae()},se=()=>{d.props.menuTrigger===`hover`&&d.props.mode===`horizontal`||d.props.collapse&&d.props.mode===`vertical`||e.disabled||d.handleSubMenuClick({index:e.index,indexPath:s.value,active:k.value})},I=(t,n=re.value)=>{var r;if(t.type!==`focus`){if(d.props.menuTrigger===`click`&&d.props.mode===`horizontal`||!d.props.collapse&&d.props.mode===`vertical`||e.disabled){f.mouseInChild.value=!0;return}f.mouseInChild.value=!0,_?.(),{stop:_}=Ve(()=>{d.openMenu(e.index,s.value)},n),T.value&&((r=c.value.vnode.el)==null||r.dispatchEvent(new MouseEvent(`mouseenter`)))}},ce=(t=!1)=>{var n;if(d.props.menuTrigger===`click`&&d.props.mode===`horizontal`||!d.props.collapse&&d.props.mode===`vertical`){f.mouseInChild.value=!1;return}_?.(),f.mouseInChild.value=!1,{stop:_}=Ve(()=>!v.value&&d.closeMenu(e.index,s.value),ie.value),T.value&&t&&((n=f.handleMouseleave)==null||n.call(f,!0))};Y(()=>d.props.collapse,e=>oe(!!e));{let e=e=>{g.value[e.index]=e},t=e=>{delete g.value[e.index]};xe(`${gt}${i.uid}`,{addSubMenu:e,removeSubMenu:t,handleMouseleave:ce,mouseInChild:v,level:f.level+1})}return r({opened:O}),B(()=>{d.addSubMenu(M),f.addSubMenu(M)}),ve(()=>{f.removeSubMenu(M),d.removeSubMenu(M)}),()=>{var r;let s=[(r=t.title)?.call(t),P(n,{class:u.e(`icon-arrow`),style:{transform:O.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&d.props.collapse?`none`:`rotateZ(180deg)`:`none`}},{default:()=>L(C.value)?P(i.appContext.components[C.value]):P(C.value)})],c=d.isMenuPopup?P(a,{ref:b,visible:O.value,effect:`light`,pure:!0,offset:te.value,showArrow:!1,persistent:j.value,popperClass:F.value,placement:S.value,teleported:T.value,fallbackPlacements:D.value,transition:E.value,gpuAcceleration:!1},{content:()=>{var e;return P(`div`,{class:[l.m(A.value),l.m(`popup-container`),F.value],onMouseenter:e=>I(e,100),onMouseleave:()=>ce(!0),onFocus:e=>I(e,100)},[P(`ul`,{class:[l.b(),l.m(`popup`),l.m(`popup-${S.value}`)],style:N.value},[(e=t.default)?.call(t)])])},default:()=>P(`div`,{class:u.e(`title`),onClick:se},s)}):P(o,{},[P(`div`,{class:u.e(`title`),ref:y,onClick:se},s),P(et,{},{default:()=>{var e;return Z(P(`ul`,{role:`menu`,class:[l.b(),l.m(`inline`)],style:N.value},[(e=t.default)?.call(t)]),[[Ue,O.value]])}})]);return P(`li`,{class:[u.b(),u.is(`active`,k.value),u.is(`opened`,O.value),u.is(`disabled`,e.disabled)],role:`menuitem`,ariaHaspopup:!0,ariaExpanded:O.value,onMouseenter:I,onMouseleave:()=>ce(),onFocus:I},[c])}}});const bt=y({mode:{type:String,values:[`horizontal`,`vertical`],default:`vertical`},defaultActive:{type:String,default:``},defaultOpeneds:{type:A(Array),default:()=>ge([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:[`hover`,`click`],default:`hover`},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:F,default:()=>he},popperEffect:{type:A(String),default:`dark`},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},persistent:{type:Boolean,default:!0}}),xt=e=>re(e)&&e.every(e=>L(e)),St={close:(e,t)=>L(e)&&xt(t),open:(e,t)=>L(e)&&xt(t),select:(e,t,n,r)=>L(e)&&xt(t)&&I(n)&&(le(r)||r instanceof Promise)};var Ct=k({name:`ElMenu`,props:bt,emits:St,setup(e,{emit:t,slots:r,expose:i}){let a=ee(),o=a.appContext.config.globalProperties.$router,s=H(),c=J(`menu`),l=J(`sub-menu`),u=H(-1),d=H(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),f=H(e.defaultActive),p=H({}),m=H({}),h=x(()=>e.mode===`horizontal`||e.mode===`vertical`&&e.collapse),g=()=>{let t=f.value&&p.value[f.value];if(!t||e.mode===`horizontal`||e.collapse)return;let n=t.indexPath;n.forEach(e=>{let t=m.value[e];t&&_(e,t.indexPath)})},_=(n,r)=>{d.value.includes(n)||(e.uniqueOpened&&(d.value=d.value.filter(e=>r.includes(e))),d.value.push(n),t(`open`,n,r))},v=e=>{let t=d.value.indexOf(e);t!==-1&&d.value.splice(t,1)},y=(e,n)=>{v(e),t(`close`,e,n)},b=({index:e,indexPath:t})=>{let n=d.value.includes(e);n?y(e,t):_(e,t)},S=n=>{(e.mode===`horizontal`||e.collapse)&&(d.value=[]);let{index:r,indexPath:i}=n;if(!(se(r)||se(i)))if(e.router&&o){let e=n.route||r,a=o.push(e).then(e=>(e||(f.value=r),e));t(`select`,r,i,{index:r,indexPath:i,route:e},a)}else f.value=r,t(`select`,r,i,{index:r,indexPath:i})},C=t=>{var n;let r=p.value,i=r[t]||f.value&&r[f.value]||r[e.defaultActive];f.value=(n=i?.index)??t},w=e=>{let t=getComputedStyle(e),n=Number.parseInt(t.marginLeft,10),r=Number.parseInt(t.marginRight,10);return e.offsetWidth+n+r||0},T=()=>{var e,t;if(!s.value)return-1;let n=Array.from((t=(e=s.value)?.childNodes)??[]).filter(e=>e.nodeName!==`#text`||e.nodeValue),r=64,i=getComputedStyle(s.value),a=Number.parseInt(i.paddingLeft,10),o=Number.parseInt(i.paddingRight,10),c=s.value.clientWidth-a-o,l=0,u=0;return n.forEach((e,t)=>{e.nodeName!==`#comment`&&(l+=w(e),l<=c-r&&(u=t+1))}),u===n.length?-1:u},E=e=>m.value[e].indexPath,D=(e,t=33.34)=>{let n;return()=>{n&&clearTimeout(n),n=setTimeout(()=>{e()},t)}},O=!0,k=()=>{if(u.value===T())return;let e=()=>{u.value=-1,_e(()=>{u.value=T()})};O?e():D(e)(),O=!1};Y(()=>e.defaultActive,e=>{p.value[e]||(f.value=``),C(e)}),Y(()=>e.collapse,e=>{e&&(d.value=[])}),Y(p.value,g);let A;We(()=>{e.mode===`horizontal`&&e.ellipsis?A=Re(s,k).stop:A?.()});let j=H(!1);{let t=e=>{m.value[e.index]=e},n=e=>{delete m.value[e.index]},r=e=>{p.value[e.index]=e},i=e=>{delete p.value[e.index]};xe(ht,Se({props:e,openedMenus:d,items:p,subMenus:m,activeIndex:f,isMenuPopup:h,addMenuItem:r,removeMenuItem:i,addSubMenu:t,removeSubMenu:n,openMenu:_,closeMenu:y,handleMenuItemClick:S,handleSubMenuClick:b})),xe(`${gt}${a.uid}`,{addSubMenu:t,removeSubMenu:n,mouseInChild:j,level:0})}B(()=>{e.mode===`horizontal`&&new ct(a.vnode.el,c.namespace.value)});{let e=e=>{let{indexPath:t}=m.value[e];t.forEach(e=>_(e,t))};i({open:e,close:v,updateActiveIndex:C,handleResize:k})}let N=mt(e,0);return()=>{var i,a;let o=(a=(i=r.default)?.call(r))??[],f=[];if(e.mode===`horizontal`&&s.value){let t=M(o),r=u.value===-1?t:t.slice(0,u.value),i=u.value===-1?[]:t.slice(u.value);i?.length&&e.ellipsis&&(o=r,f.push(P(yt,{index:`sub-menu-more`,class:l.e(`hide-arrow`),popperOffset:e.popperOffset},{title:()=>P(n,{class:l.e(`icon-more`)},{default:()=>P(e.ellipsisIcon)}),default:()=>i})))}let p=e.closeOnClickOutside?[[Xe,()=>{d.value.length&&(j.value||(d.value.forEach(e=>t(`close`,e,E(e))),d.value=[]))}]]:[],m=Z(P(`ul`,{key:String(e.collapse),role:`menubar`,ref:s,style:N.value,class:{[c.b()]:!0,[c.m(e.mode)]:!0,[c.m(`collapse`)]:e.collapse}},[...o,...f]),p);return e.collapseTransition&&e.mode===`vertical`?P(dt,()=>m):m}}});const wt=y({index:{type:A([String,null]),default:null},route:{type:A([String,Object])},disabled:Boolean}),Tt={click:e=>L(e.index)&&re(e.indexPath)},Et=`ElMenuItem`,Dt=k({name:Et}),Ot=k({...Dt,props:wt,emits:Tt,setup(e,{expose:t,emit:n}){let r=e;ce(r.index)&&O(Et,`Missing required prop: "index"`);let i=ee(),s=ne(ht),c=J(`menu`),l=J(`menu-item`);s||De(Et,`can not inject root menu`);let{parentMenu:u,indexPath:d}=ft(i,Ae(r,`index`)),f=ne(`${gt}${u.value.uid}`);f||De(Et,`can not inject sub menu`);let p=x(()=>r.index===s.activeIndex),m=Se({index:r.index,indexPath:d,active:p}),h=()=>{r.disabled||(s.handleMenuItemClick({index:r.index,indexPath:d.value,route:r.route}),n(`click`,m))};return B(()=>{f.addSubMenu(m),s.addMenuItem(m)}),ve(()=>{f.removeSubMenu(m),s.removeMenuItem(m)}),t({parentMenu:u,rootMenu:s,active:p,nsMenu:c,nsMenuItem:l,handleClick:h}),(e,t)=>(V(),T(`li`,{class:R([q(l).b(),q(l).is(`active`,q(p)),q(l).is(`disabled`,e.disabled)]),role:`menuitem`,tabindex:`-1`,onClick:h},[q(u).type.name===`ElMenu`&&q(s).props.collapse&&e.$slots.title?(V(),C(q(a),{key:0,effect:q(s).props.popperEffect,placement:`right`,"fallback-placements":[`left`],persistent:q(s).props.persistent},{content:X(()=>[W(e.$slots,`title`)]),default:X(()=>[S(`div`,{class:R(q(c).be(`tooltip`,`trigger`))},[W(e.$slots,`default`)],2)]),_:3},8,[`effect`,`persistent`])):(V(),T(o,{key:1},[W(e.$slots,`default`),W(e.$slots,`title`)],64))],2))}});var kt=d(Ot,[[`__file`,`menu-item.vue`]]);const At={title:String},jt=k({name:`ElMenuItemGroup`}),Mt=k({...jt,props:At,setup(e){let t=J(`menu-item-group`);return(e,n)=>(V(),T(`li`,{class:R(q(t).b())},[S(`div`,{class:R(q(t).e(`title`))},[e.$slots.title?W(e.$slots,`title`,{key:1}):(V(),T(o,{key:0},[E(K(e.title),1)],64))],2),S(`ul`,null,[W(e.$slots,`default`)])],2))}});var Nt=d(Mt,[[`__file`,`menu-item-group.vue`]]);const Pt=Ge(Ct,{MenuItem:kt,MenuItemGroup:Nt,SubMenu:yt}),Ft=Je(kt),It=Je(Nt),Lt=Je(yt),Rt=[`primary`,`success`,`info`,`warning`,`error`],zt=y({customClass:{type:String,default:``},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:F},id:{type:String,default:``},message:{type:A([String,Object,Function]),default:``},offset:{type:Number,default:0},onClick:{type:A(Function),default:()=>void 0},onClose:{type:A(Function),required:!0},position:{type:String,values:[`top-right`,`top-left`,`bottom-right`,`bottom-left`],default:`top-right`},showClose:{type:Boolean,default:!0},title:{type:String,default:``},type:{type:String,values:[...Rt,``],default:``},zIndex:Number,closeIcon:{type:F,default:b}}),Bt={destroy:()=>!0},Vt=k({name:`ElNotification`}),Ht=k({...Vt,props:zt,emits:Bt,setup(t,{expose:r}){let i=t,{ns:a,zIndex:s}=Pe(`notification`),{nextZIndex:u,currentZIndex:d}=s,f=H(!1),p,m=x(()=>{let e=i.type;return e&&l[i.type]?a.m(e):``}),h=x(()=>i.type&&l[i.type]||i.icon),g=x(()=>i.position.endsWith(`right`)?`right`:`left`),_=x(()=>i.position.startsWith(`top`)?`top`:`bottom`),v=x(()=>{var e;return{[_.value]:`${i.offset}px`,zIndex:(e=i.zIndex)??d.value}});function y(){i.duration>0&&({stop:p}=Ve(()=>{f.value&&E()},i.duration))}function b(){p?.()}function E(){f.value=!1}function D({code:t}){t===e.delete||t===e.backspace?b():t===e.esc?f.value&&E():y()}return B(()=>{y(),u(),f.value=!0}),Ne(document,`keydown`,D),r({visible:f,close:E}),(e,t)=>(V(),C(c,{name:q(a).b(`fade`),onBeforeLeave:e.onClose,onAfterLeave:t=>e.$emit(`destroy`),persisted:``},{default:X(()=>[Z(S(`div`,{id:e.id,class:R([q(a).b(),e.customClass,q(g)]),style:z(q(v)),role:`alert`,onMouseenter:b,onMouseleave:y,onClick:e.onClick},[q(h)?(V(),C(q(n),{key:0,class:R([q(a).e(`icon`),q(m)])},{default:X(()=>[(V(),C(G(q(h))))]),_:1},8,[`class`])):w(`v-if`,!0),S(`div`,{class:R(q(a).e(`group`))},[S(`h2`,{class:R(q(a).e(`title`)),textContent:K(e.title)},null,10,[`textContent`]),Z(S(`div`,{class:R(q(a).e(`content`)),style:z(e.title?void 0:{margin:0})},[W(e.$slots,`default`,{},()=>[e.dangerouslyUseHTMLString?(V(),T(o,{key:1},[w(` Caution here, message could've been compromised, never use user's input as message `),S(`p`,{innerHTML:e.message},null,8,[`innerHTML`])],2112)):(V(),T(`p`,{key:0},K(e.message),1))])],6),[[Ue,e.message]]),e.showClose?(V(),C(q(n),{key:0,class:R(q(a).e(`closeBtn`)),onClick:qe(E,[`stop`])},{default:X(()=>[(V(),C(G(e.closeIcon)))]),_:1},8,[`class`,`onClick`])):w(`v-if`,!0)],2)],46,[`id`,`onClick`]),[[Ue,f.value]])]),_:3},8,[`name`,`onBeforeLeave`,`onAfterLeave`]))}});var Ut=d(Ht,[[`__file`,`notification.vue`]]);const Wt={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},Gt=16;let Kt=1;const $=function(e={},t){if(!ie)return{close:()=>void 0};(L(e)||ue(e))&&(e={message:e});let n=e.position||`top-right`,r=e.offset||0;Wt[n].forEach(({vm:e})=>{var t;r+=((t=e.el)?.offsetHeight||0)+Gt}),r+=Gt;let i=`notification_${Kt++}`,a=e.onClose,o={...e,offset:r,id:i,onClose:()=>{qt(i,n,a)}},s=document.body;ae(e.appendTo)?s=e.appendTo:L(e.appendTo)&&(s=document.querySelector(e.appendTo)),ae(s)||(O(`ElNotification`,`the appendTo option is not an HTMLElement. Falling back to document.body.`),s=document.body);let c=document.createElement(`div`),l=D(Ut,o,oe(o.message)?o.message:ue(o.message)?()=>o.message:null);return l.appContext=le(t)?$._context:t,l.props.onDestroy=()=>{we(null,c)},we(l,c),Wt[n].push({vm:l}),s.appendChild(c.firstElementChild),{close:()=>{l.component.exposed.visible.value=!1}}};Rt.forEach(e=>{$[e]=(t={},n)=>((L(t)||ue(t))&&(t={message:t}),$({...t,type:e},n))});function qt(e,t,n){let r=Wt[t],i=r.findIndex(({vm:t})=>{var n;return(n=t.component)?.props.id===e});if(i===-1)return;let{vm:a}=r[i];if(!a)return;n?.(a);let o=a.el.offsetHeight,s=t.split(`-`)[0];r.splice(i,1);let c=r.length;if(!(c<1))for(let e=i;e<c;e++){let{el:t,component:n}=r[e].vm,i=Number.parseInt(t.style[s],10)-o-Gt;n.props.offset=i}}function Jt(){for(let e of Object.values(Wt))e.forEach(({vm:e})=>{e.component.exposed.visible.value=!1})}$.closeAll=Jt,$._context=null;const Yt=Ke($,`$notify`);function Xt(){let e=Be(),t=e=>{let{route:t}=e;return{path:t.path.startsWith(`/`)?t.path:`/${t.path}`,name:t.name,title:t.meta?.title||``,icon:t.meta?.icon,index:e.index.toString()}},n=x(()=>{let n=e.getRoutes(),r=[],i=n.find(e=>e.name===`layout`);return i&&i.children&&i.children.forEach((e,n)=>{if(e.meta&&e.meta.title&&e.meta.icon){let i=t({route:e,index:n});r.push(i)}}),r}),r=(e,n,i)=>{let a;e?.meta?.title&&(a=t({route:e,index:typeof n==`string`?parseInt(n):n})),a&&e.children?.length&&(a.children=[],e.children.forEach((e,t)=>{a?.children&&r(e,`${n}-${t}`,a.children)})),a&&i.push(a)},i=x(()=>{let t=[...e.getRoutes()],n=[],i=t.filter(e=>e.name===`layout`);for(let e=0;e<i.length;e++)r(i[e],e,n);return n}),a=e=>{let t=n.value.find(t=>t.path===e);return t||=n.value.find(t=>{let n=t.path.endsWith(`/`)?t.path:t.path+`/`,r=e.endsWith(`/`)?e:e+`/`;return r.startsWith(n)||e.startsWith(t.path)}),t?t.index:`0`},o=e=>{let t=n.value.find(t=>t.index===e);return t?t.path:``},s=e=>n.value.find(t=>t.index===e);return{menuRoutes:n,layoutRoute:i,getActiveIndexByPath:a,getRoutePathByIndex:o,getRouteByIndex:s}}var Zt=k({__name:`RecursiveMenuItem`,props:{item:{},parentIndex:{},childIndex:{}},emits:[`menu-select`],setup(e,{emit:t}){let r=t,i=e=>{r(`menu-select`,e)},a=e=>{let t=[];if(e.name){let n=e.name.split(`-`)[1];n&&t.push(`menu-item-${n}`)}else if(e.path){let n=e.path.split(`/`),r=n[n.length-1];r&&t.push(`menu-item-${r}`)}return t.join(` `)};return(e,t)=>{let r=n,s=Te(`RecursiveMenuItem`,!0),c=Lt,l=Ft;return e.item.children&&e.item.children.length>0?(V(),C(c,{index:e.item.path,key:e.item.path},{title:X(()=>[e.item.icon?(V(),C(r,{key:0},{default:X(()=>[(V(),C(G(e.item.icon)))]),_:1})):w(``,!0),S(`span`,null,K(e.item.title),1)]),default:X(()=>[(V(!0),T(o,null,U(e.item.children,(t,n)=>(V(),C(s,{key:t.path||n,item:t,"parent-index":e.item.path,"child-index":n,onMenuSelect:i},null,8,[`item`,`parent-index`,`child-index`]))),128))]),_:1},8,[`index`])):(V(),C(l,{index:e.item.path,key:e.item.path,class:R(a(e.item)),onClick:t[0]||=t=>i(e.item)},{default:X(()=>[e.item.icon?(V(),C(r,{key:0},{default:X(()=>[(V(),C(G(e.item.icon)))]),_:1})):w(``,!0),S(`span`,null,K(e.item.title),1)]),_:1},8,[`index`,`class`]))}}}),Qt=u(Zt,[[`__scopeId`,`data-v-7f352830`]]);const $t={key:0,class:`minimized-modal-menu`},en={key:0,class:`minimized-group-title`},tn=[`onClick`],nn={key:0,class:`minimized-modal-title`};var rn=k({__name:`MinimizedModalMenu`,props:{collapsed:{type:Boolean}},setup(e){let{minimizedMenuItems:t,getModalIcon:r,getModalColor:i}=Ie(),a=e=>{let t={Document:j,Operation:be,User:He,List:fe,Tickets:Oe};return t[e]||j};return(e,s)=>{let c=at,l=n,u=Ee(`tooltip-overflow`);return q(t).length>0?(V(),T(`div`,$t,[D(c,{class:`menu-divider`}),e.collapsed?w(``,!0):(V(),T(`div`,en,[D(l,null,{default:X(()=>[D(q(me))]),_:1}),s[0]||=S(`span`,null,`最小化窗口`,-1)])),(V(!0),T(o,null,U(q(t),t=>(V(),T(`div`,{key:`minimized-${t.id}`,class:R([`minimized-modal-item`,{collapsed:e.collapsed}]),onClick:t.onClick},[D(l,{style:z({color:q(i)(t.type)})},{default:X(()=>[(V(),C(G(a(q(r)(t.type)))))]),_:2},1032,[`style`]),e.collapsed?w(``,!0):Z((V(),T(`span`,nn,[E(K(t.title),1)])),[[u]])],10,tn))),128))])):w(``,!0)}}}),an=u(rn,[[`__scopeId`,`data-v-0f80ef92`]]);const on={class:`control-sidebar-wrapper`},sn={class:`menu-container`};var cn=k({__name:`ControlSidebar`,emits:[`collapse`],setup(e,{emit:t}){let r=ze(),i=t,a=Be(),s=H(!1),c=H(`0`),l=H([]),{menuRoutes:u,layoutRoute:d,getRoutePathByIndex:f}=Xt(),p=()=>{s.value=!s.value,i(`collapse`,s.value)},g=e=>{if(c.value=e,!e.startsWith(`layout-`)&&e.startsWith(`menu-`)){let t=e.replace(`menu-`,``),n=f(t);n&&a.push(n)}},_=e=>{e.path&&(a.push(e.path),c.value=e.path)},v=e=>{l.value.includes(e)||l.value.push(e)},y=e=>{let t=l.value.indexOf(e);t!==-1&&l.value.splice(t,1)};return Y(()=>r.path,e=>{if(e.startsWith(`/mas/`)){let e=`/`;l.value.includes(e)||l.value.push(e)}let t=u.value.find(t=>t.path===e);if(t){c.value=`menu-${t.index}`;return}let n=t=>{for(let r of t){if(r.path===e)return r.path;if(r.children){let e=n(r.children);if(e)return e}}return null},r=n(d.value);if(r){c.value=r;return}c.value=e},{immediate:!0}),(e,t)=>{let r=n,i=Ft,a=Pt;return V(),T(`div`,on,[S(`div`,{class:`collapse-btn`,onClick:p},[D(r,{class:R([`collapse-icon`,{"is-collapsed":s.value}])},{default:X(()=>[s.value?(V(),C(q(h),{key:1})):(V(),C(q(m),{key:0}))]),_:1},8,[`class`])]),S(`div`,sn,[D(a,{"default-active":c.value,"default-opened-keys":l.value,collapse:s.value,class:`mas-menu`,"background-color":`#001529`,"text-color":`#fff`,"active-text-color":`#1890ff`,onSelect:g,onOpen:v,onClose:y},{default:X(()=>[(V(!0),T(o,null,U(q(d),(e,t)=>(V(),C(Qt,{key:`layout-${e.path||t}`,item:e,onMenuSelect:_},null,8,[`item`]))),128)),(V(!0),T(o,null,U(q(u),e=>(V(),C(i,{key:`menu-${e.index}`,index:`menu-${e.index}`,class:R(`menu-item-${e.name.split(`-`)[1]}`)},{default:X(()=>[D(r,null,{default:X(()=>[(V(),C(G(e.icon)))]),_:2},1024),S(`span`,null,K(e.title),1)]),_:2},1032,[`index`,`class`]))),128)),D(an,{collapsed:s.value},null,8,[`collapsed`])]),_:1},8,[`default-active`,`default-opened-keys`,`collapse`])])])}}}),ln=u(cn,[[`__scopeId`,`data-v-516accc2`]]);const un={class:`human-agent-binding`},dn={key:0,class:`binding-form`},fn={class:`form-content`},pn={class:`input-group`},mn={class:`input-group`},hn={key:1,class:`binding-summary`},gn={class:`agent-name`};var _n=k({__name:`HumanAgentBinding`,props:{boundAgent:{}},emits:[`update:boundAgent`,`agentBound`],setup(e,{emit:n}){let o=e,s=n,c=Fe(),l=Le(),u=x(()=>o.boundAgent||c.currentHumanAgent),d=H(``),f=H(``),p=H(!1),m=H(`primary`),h=H(`确认`),g=H(null),_=()=>{g.value&&clearTimeout(g.value),g.value=window.setTimeout(()=>{m.value=`primary`,h.value=`确认`},2e3)},y=()=>{m.value=`success`,h.value=`绑定成功`,_()},b=()=>{m.value=`danger`,h.value=`绑定失败`,_()},C=e=>{e.preventDefault();let t=e.dataTransfer?.getData(`text/plain`);if(t)try{let e=JSON.parse(t);e.type===`agent`&&e.agent_id&&(d.value=e.agent_id,i.success(`已自动填入Agent ID`))}catch(e){console.error(`解析拖拽数据失败:`,e)}},w=async()=>{if(!d.value||!f.value){i.warning(`请填写完整信息`);return}p.value=!0;try{let e=await v(d.value,f.value);if(!e.success){b(),i.error(e.message);return}let t=await N(`agent`),n=Object.keys(t).find(e=>t[e].agent_id===d.value);if(n&&t[n]){let r=t[n];if(!n.includes(`Human`)){b(),i.error(`该Agent不是人类操作端Agent`);return}s(`update:boundAgent`,r),s(`agentBound`,r);try{await c.setHumanAgentLogin(r.agent_id,r)}catch(e){console.error(`保存登录信息失败，但不影响绑定操作:`,e)}d.value=``,f.value=``,y(),i.success(e.message)}else b(),i.error(`Agent ID不存在`)}catch(e){console.error(`绑定失败:`,e),b(),i.error(`绑定失败，请检查Agent ID和密码`)}finally{p.value=!1}},O=async()=>{await c.clearHumanAgentLogin(),s(`update:boundAgent`,null),d.value=``,f.value=``,g.value&&clearTimeout(g.value),m.value=`primary`,h.value=`确认`},k=()=>{if(!u.value){i.warning(`没有绑定的Agent`);return}try{l.createModal({type:`agent`,title:`Agent详情 - [${u.value.role}]${u.value.name}`,id:u.value.agent_id,data:u.value,slots:{default:`AgentInfo`},componentProps:{agentData:u.value}})}catch(e){console.error(`Error creating modal:`,e),console.error(`Error stack:`,e instanceof Error?e.stack:`No stack trace`),i.error(`打开Agent详情失败`)}},A=e=>{let t={idle:`status-idle`,working:`status-working`,waiting:`status-waiting`,finished:`status-finished`,failed:`status-failed`};return t[e]||`status-idle`},j=e=>{let t={idle:`空闲`,working:`工作中`,waiting:`等待中`,finished:`已完成`,failed:`失败`};return t[e]||`未知`};return ye(()=>{g.value&&clearTimeout(g.value)}),Y(()=>c.currentHumanAgent,e=>{e&&!o.boundAgent&&s(`update:boundAgent`,e)},{immediate:!0}),(e,n)=>{let i=r,o=t,s=a;return V(),T(`div`,un,[u.value?(V(),T(`div`,hn,[S(`div`,{class:`bound-agent-info`,onDblclick:k},[S(`div`,gn,`[`+K(u.value.role)+`] `+K(u.value.name),1)],32),D(s,{content:`更换绑定的HumanAgent`,placement:`top`,"show-after":500},{default:X(()=>[D(o,{size:`small`,onClick:O},{default:X(()=>n[7]||=[E(` 更换 `)]),_:1,__:[7]})]),_:1})])):(V(),T(`div`,dn,[n[6]||=S(`div`,{class:`form-title`},`绑定人类操作端`,-1),S(`div`,fn,[S(`div`,pn,[n[4]||=S(`label`,null,`Agent ID`,-1),D(i,{modelValue:d.value,"onUpdate:modelValue":n[0]||=e=>d.value=e,placeholder:`请输入要绑定的Agent ID (或拖入要绑定的Agent详细信息窗口)`,class:`agent-id-input`,clearable:``,onDrop:C,onDragover:n[1]||=qe(()=>{},[`prevent`]),onDragenter:n[2]||=qe(()=>{},[`prevent`])},null,8,[`modelValue`])]),S(`div`,mn,[n[5]||=S(`label`,null,`访问密码`,-1),D(i,{modelValue:f.value,"onUpdate:modelValue":n[3]||=e=>f.value=e,clearable:``,type:`password`,placeholder:`请输入要绑定的Agent的访问密码`,"show-password":``},null,8,[`modelValue`])]),D(o,{type:m.value,loading:p.value,disabled:!d.value||!f.value,class:`confirm-button`,onClick:w},{default:X(()=>[E(K(h.value),1)]),_:1},8,[`type`,`loading`,`disabled`])])]))])}}}),vn=u(_n,[[`__scopeId`,`data-v-c27d242a`]]);const yn={class:`message-management`},bn={key:0,class:`conversation-list`},xn={class:`group-conversations`},Sn=[`onDblclick`],Cn={class:`conversation-info`},wn={class:`task-name`},Tn={class:`participant-count`},En={key:0,class:`unread-indicator`},Dn={class:`private-conversations`},On=[`onDblclick`],kn={class:`conversation-info`},An={class:`task-name`},jn={class:`agent-info`},Mn={key:0,class:`unread-indicator`},Nn={key:0,class:`empty-state`},Pn={key:1,class:`unbound-state`};var Fn=k({__name:`MessageManagement`,props:{boundAgent:{}},emits:[`openConversation`],setup(e,{emit:t}){let n=e,r=t,a=H([]),s=H([]),c=Le(),l=Fe(),u=e=>{let t=l.agents.find(t=>t.agent_id===e);return t?.name||e.slice(-6)},d=e=>{let t=l.agents.find(t=>t.agent_id===e);return t?.role||`未知`},f=async()=>{if(!n.boundAgent?.working_memory)return;let e=await N(`task`),t=[];for(let r of Object.keys(n.boundAgent.working_memory)){let n=Object.keys(e).find(t=>e[t].task_id===r);if(n&&e[n]){let r=e[n];r.shared_conversation_pool&&r.shared_conversation_pool.length>0&&t.push({taskId:r.task_id,taskName:r.task_name,participantCount:r.task_group.length,hasUnread:!1,messages:r.shared_conversation_pool})}}a.value=t},p=async()=>{if(!n.boundAgent?.conversation_pool?.conversation_privates)return;let e=await N(`agent`),t=await N(`task`),r=[];for(let[i,a]of Object.entries(n.boundAgent.conversation_pool.conversation_privates)){let n=Object.keys(e).find(t=>e[t].agent_id===i);if(n&&e[n]){let i=e[n];for(let[e,n]of Object.entries(a)){let a=Object.keys(t).find(n=>t[n].task_id===e);if(a&&t[a]&&Array.isArray(n)&&n.length>0){let e=t[a];r.push({agentId:i.agent_id,taskId:e.task_id,taskName:e.task_name,name:i.name,role:i.role,hasUnread:!1,messages:n})}}}}s.value=r},m=(e,t)=>{let a=n.boundAgent?.agent_id;if(!a){i.error(`HumanAgent ID 不存在`);return}if(e===`private`){let e=t.agentId;c.createModal({type:`chat`,title:`与 [${d(e)}]${u(e)} 的消息`,id:a,data:{humanAgentId:a,targetAgentId:e},componentProps:{humanAgentId:a,targetAgentId:e},size:{width:1e3,height:700}})}else if(e===`group`){let e=t;c.createModal({type:`chat`,title:`群聊 - ${e.taskName}`,id:`${a}-${e.taskId}`,data:{humanAgentId:a,taskId:e.taskId},componentProps:{humanAgentId:a,taskId:e.taskId},size:{width:1200,height:800}})}r(`openConversation`,{type:e,conversation:t,boundAgent:n.boundAgent})};return Y(()=>n.boundAgent,async e=>{e?await Promise.all([f(),p()]):(a.value=[],s.value=[])},{immediate:!0,deep:!0}),(e,t)=>(V(),T(`div`,yn,[t[2]||=S(`div`,{class:`header`},[S(`span`,{class:`title`},`消息管理`)],-1),e.boundAgent?(V(),T(`div`,bn,[S(`div`,xn,[(V(!0),T(o,null,U(a.value,e=>(V(),T(`div`,{key:e.taskId,class:`conversation-item group-conversation`,onDblclick:t=>m(`group`,e)},[S(`div`,Cn,[S(`div`,wn,K(e.taskName),1),S(`div`,Tn,`[`+K(e.participantCount)+`]`,1)]),e.hasUnread?(V(),T(`div`,En)):w(``,!0)],40,Sn))),128))]),S(`div`,Dn,[(V(!0),T(o,null,U(s.value,e=>(V(),T(`div`,{key:`${e.agentId}-${e.taskId}`,class:`conversation-item private-conversation`,onDblclick:t=>m(`private`,e)},[S(`div`,kn,[S(`div`,An,K(e.taskName),1),S(`div`,jn,`[`+K(e.role)+`] `+K(e.name),1)]),e.hasUnread?(V(),T(`div`,Mn)):w(``,!0)],40,On))),128))]),!a.value.length&&!s.value.length?(V(),T(`div`,Nn,t[0]||=[S(`div`,{class:`empty-icon`},`💬`,-1),S(`div`,{class:`empty-text`},`暂无对话`,-1)])):w(``,!0)])):(V(),T(`div`,Pn,t[1]||=[S(`div`,{class:`unbound-icon`},`🔗`,-1),S(`div`,{class:`unbound-text`},`请先绑定HumanAgent`,-1)]))]))}}),In=u(Fn,[[`__scopeId`,`data-v-bf750c6b`]]);const Ln=new de({html:!0,breaks:!0,linkify:!0,typographer:!0}),Rn=[`script`,`object`,`embed`,`form`,`input`,`button`,`select`,`textarea`,`iframe`,`frame`,`frameset`,`applet`,`base`,`link`,`meta`,`style`],zn=e=>{let t=e;return Rn.forEach(e=>{let n=RegExp(`</?${e}[^>]*>`,`gi`);t=t.replace(n,``)}),t=t.replace(/javascript:/gi,``),t=t.replace(/\s*on\w+\s*=\s*[^>]*/gi,``),t},Bn=(e,t=!0)=>{if(!e)return``;let n=Ln.render(e);return t&&(n=zn(n)),n},Vn={class:`global-message-notification`},Hn={class:`header`},Un={class:`title`},Wn={key:0},Gn={class:`message-list`},Kn={class:`message-content`},qn={key:0,class:`empty-message`};var Jn=k({__name:`GlobalMessageNotification`,props:{boundAgent:{}},setup(e){let t=e,r=Fe(),i=H(!1),s=H(!1),c=H(0),l=x(()=>t.boundAgent||r.currentHumanAgent||null),u=x(()=>{let e=l.value;return e?e?.agent_id?.includes(`Human`)||typeof r.isCurrentHumanAgent==`function`&&r.isCurrentHumanAgent(e.agent_id):!1}),d=x(()=>{let e=l.value,t=e?.conversation_pool?.global_messages??e?.conversation?.global_messages??e?.conversation?.global_mesages??e?.conversation_pool?.global_mesages??[];return Array.isArray(t)?t:[]}),f=x(()=>[...d.value].reverse());Y(d,e=>{if(e.length>c.value){let t=e.slice(c.value);if(s.value=!0,c.value=e.length,u.value&&t.length){let e=t.slice(-3);e.forEach(e=>{let t=Bn(e,!0),n=`<div class=\"mas-global-msg\">${t}</div>`;Yt({title:`全局消息`,message:n,dangerouslyUseHTMLString:!0,position:`bottom-right`,duration:1500,type:`info`,showClose:!0,customClass:`global-msg-pop`})}),_e(()=>{try{let e=document.querySelectorAll(`.el-notification.global-msg-pop .el-notification__content .mas-global-msg`);e.forEach(e=>{let t=e;t.__mas_link_processed__||(je(t),g(t),t.__mas_link_processed__=!0)})}catch(e){console.warn(`Notification MAS link batch transform failed:`,e)}})}}},{deep:!0,immediate:!0});let p=()=>{i.value=!0,s.value=!1},m=()=>{i.value=!1};B(()=>{});let h=e=>{if(i.value){let t=e.target;t.closest(`.global-message-notification`)||m()}};return B(()=>{document.addEventListener(`click`,h)}),ye(()=>{document.removeEventListener(`click`,h)}),(e,t)=>{let r=n,c=a,l=Ee(`tooltip-overflow`),u=Ee(`markdown`);return V(),T(`div`,Vn,[i.value?w(``,!0):(V(),T(`div`,{key:0,class:R([`notification-icon`,{"has-new-message":s.value}]),onClick:qe(p,[`stop`])},[D(c,{content:`全局消息`,placement:`bottom`},{default:X(()=>[D(r,{size:20},{default:X(()=>[D(q(_))]),_:1})]),_:1})],2)),i.value?(V(),T(`div`,{key:1,class:`notification-expanded`,onClick:t[0]||=qe(()=>{},[`stop`])},[S(`div`,Hn,[Z((V(),T(`span`,Un,[t[1]||=E(`全局消息`),f.value.length?(V(),T(`span`,Wn,` (`+K(f.value.length)+`)`,1)):w(``,!0)])),[[l]]),D(r,{class:`close-btn`,onClick:m},{default:X(()=>[D(q(b))]),_:1})]),S(`div`,Gn,[(V(!0),T(o,null,U(f.value,(e,t)=>(V(),T(`div`,{key:`message-${t}`,class:`message-item`},[Z(S(`div`,Kn,null,512),[[u,{content:e,safe:!0,options:{breaks:!0,linkify:!0}}]])]))),128)),f.value.length?w(``,!0):(V(),T(`div`,qn,`暂无全局消息`))])])):w(``,!0),i.value?(V(),T(`div`,{key:2,class:`overlay`,onClick:m})):w(``,!0)])}}}),Yn=u(Jn,[[`__scopeId`,`data-v-7d1bd9cc`]]);const Xn={class:`secondary-workspace-wrapper`},Zn={class:`agent-binding-section`},Qn={class:`message-management-section`};var $n=k({__name:`SecondaryWorkspace`,emits:[`minimize`],setup(e){let t=H(null),n=e=>{t.value=e},r=e=>{};return(e,i)=>(V(),T(`div`,Xn,[S(`div`,Zn,[D(vn,{"bound-agent":t.value,"onUpdate:boundAgent":i[0]||=e=>t.value=e,onAgentBound:n},null,8,[`bound-agent`])]),S(`div`,Qn,[D(In,{"bound-agent":t.value,onOpenConversation:r},null,8,[`bound-agent`])]),i[1]||=S(`div`,{class:`multi-function-section`},[S(`div`,{class:`placeholder`},`多功能区 - 待开发`)],-1),i[2]||=S(`div`,{class:`tool-usage-section`},[S(`div`,{class:`placeholder`},`工具使用区 - 待开发`)],-1),D(Yn,{"bound-agent":t.value,class:`notification-component`},null,8,[`bound-agent`])]))}}),er=u($n,[[`__scopeId`,`data-v-b38295fd`]]);const tr={class:`mas-layout`};var nr=k({__name:`index`,setup(e){let t=H(!1),n=H(800),r=H(300),i=H(1100),a=H(!1),o=H(0),s=H(0),c=e=>{t.value=e},l=e=>{a.value=!0,o.value=e.clientX,s.value=n.value,document.addEventListener(`mousemove`,d,{passive:!0}),document.addEventListener(`mouseup`,f),document.body.style.cursor=`col-resize`,document.body.style.userSelect=`none`,document.body.classList.add(`resizing`)},u=(e,t)=>{let n=null,r=0;return(...i)=>{let a=Date.now();a-r>t?(e(...i),r=a):(n&&clearTimeout(n),n=window.setTimeout(()=>e(...i),t-(a-r)))}},d=u(e=>{if(!a.value)return;let t=e.clientX-o.value,c=s.value+t,l=i.value-c;c>=400&&l>=250&&requestAnimationFrame(()=>{n.value=c,r.value=l})},16),f=()=>{a.value=!1,document.removeEventListener(`mousemove`,d),document.removeEventListener(`mouseup`,f),document.body.style.cursor=``,document.body.style.userSelect=``,document.body.classList.remove(`resizing`)};return B(()=>{let e=()=>{i.value=window.innerWidth-(t.value?64:200);let e=300,a=i.value-e;a>=400?(r.value=e,n.value=a):(n.value=400,r.value=Math.max(250,i.value-400))};e(),window.addEventListener(`resize`,e,{passive:!0}),ye(()=>{window.removeEventListener(`resize`,e)})}),(e,i)=>{let a=Te(`router-view`);return V(),T(`div`,tr,[S(`div`,{class:R([`control-sidebar`,{"is-collapsed":t.value}])},[D(ln,{onCollapse:c})],2),S(`div`,{class:`main-workspace`,style:z({width:`${n.value}px`})},[D(a)],4),S(`div`,{class:`workspace-divider`,onMousedown:l},i[0]||=[S(`div`,{class:`divider-handle`},[S(`div`,{class:`divider-line`})],-1)],32),S(`div`,{class:`secondary-workspace`,style:z({width:`${r.value}px`})},[D(er)],4)])}}}),rr=u(nr,[[`__scopeId`,`data-v-37c994ba`]]);export{rr as default};