import{ElIcon as e,ElMessage as t,ElTooltip as n,Fragment as r,Transition as i,__plugin_vue_export_helper_default as a,arrow_down_default as o,circle_check_default as s,circle_close_default as c,clock_default as l,computed as u,createBaseVNode as d,createBlock as f,createCommentVNode as p,createElementBlock as m,createVNode as h,defineComponent as g,loading_default as _,normalizeClass as v,onMounted as y,openBlock as b,ref as x,renderList as S,resolveDirective as C,resolveDynamicComponent as w,toDisplayString as T,unref as E,useMasStore as D,useModalStore as O,user_default as k,withCtx as A,withDirectives as j,withModifiers as M}from"./index-CruJQWlf.js";import{DetailButton_default as N,SkeletonLoader_default as P}from"./SkeletonLoader-Cm_oXXpk.js";const F={class:`agent-card-content`},I={class:`status-indicator`},L={class:`status-text`},R={class:`agent-basic`},z={class:`agent-title`},B=[`data-agent-id`],V={class:`agent-steps`},H=[`onMouseenter`,`onClick`];var U=g({__name:`AgentCard`,props:{agent:{}},emits:[`view-details`,`view-step`],setup(t,{emit:a}){let g=t,y=a,D=x(!1),O=x(null),P=`agent-card-${g.agent.agent_id}`,U=u(()=>g.agent.agent_id.toLowerCase().includes(`human`)||g.agent.conversation_pool!==void 0),W=u(()=>{if(!g.agent?.agent_step)return[];let{step_list:e}=g.agent.agent_step;return!e||e.length===0?[]:[...e]}),G=()=>{g.agent.profile&&(D.value=!D.value)},K=e=>{let t={idle:`空闲`,working:`工作中`,waiting:`等待中`,finished:`已完成`,failed:`失败`};return t[e]||e},q=e=>{let t={idle:l,working:_,waiting:l,finished:s,failed:c};return t[e]||k},J=e=>{O.value=e},Y=()=>{O.value=null},X=()=>{},Z=()=>{y(`view-details`,g.agent)},Q=e=>{y(`view-step`,e)};return(t,a)=>{let s=e,c=n,l=C(`markdown`);return b(),m(`div`,{class:v([`agent-card`,{"human-border":U.value}]),"data-component-id":P,onClick:X},[d(`div`,F,[d(`div`,{class:v([`agent-status-bar`,`status-${t.agent.working_state}`])},[d(`div`,I,[h(s,null,{default:A(()=>[(b(),f(w(q(t.agent.working_state))))]),_:1})]),d(`span`,L,T(K(t.agent.working_state)),1)],2),d(`div`,{class:`agent-info`,onClick:M(G,[`stop`])},[d(`div`,R,[d(`span`,z,T(`[${t.agent.role}] ${t.agent.name}`),1),t.agent.profile?(b(),f(s,{key:0,class:v([`expand-icon`,{rotated:D.value}])},{default:A(()=>[h(E(o))]),_:1},8,[`class`])):p(``,!0)]),h(i,{name:`profile-expand`},{default:A(()=>[D.value?j((b(),m(`div`,{key:0,class:`agent-profile`,"data-agent-id":t.agent.agent_id},null,8,B)),[[l,t.agent.profile]]):p(``,!0)]),_:1})]),d(`div`,V,[(b(!0),m(r,null,S(W.value,e=>(b(),m(`div`,{key:e.step_id,class:v([`step-block`,`status-${e.execution_state||`init`}`]),onMouseenter:t=>J(e.step_id),onMouseleave:Y,onClick:M(t=>Q(e.step_id),[`stop`])},[h(c,{content:O.value===e.step_id?e.step_intention||`无描述`:``,placement:`top`,disabled:O.value!==e.step_id},{default:A(()=>a[0]||=[d(`div`,{class:`step-content`},null,-1)]),_:2,__:[0]},1032,[`content`,`disabled`])],42,H))),128))])]),h(N,{theme:`purple`,sizeType:`medium`,onClick:Z})],2)}}}),W=a(U,[[`__scopeId`,`data-v-e2c9610c`]]);const G={class:`agent-view`},K={key:0,class:`loading-container`},q={key:1,class:`empty-state`},J=[`disabled`],Y={key:2,class:`agent-grid`};var X=g({__name:`AgentView`,setup(e){let n=D(),i=O(),a=x(!1),o=async()=>{a.value=!0;try{await Promise.all([n.getAgents(),n.getSteps()])}catch(e){t.error(`获取数据失败`),console.error(`Failed to refresh data:`,e)}finally{a.value=!1}},s=e=>{try{i.createModal({type:`agent`,title:`Agent详情 - ${e.name}`,id:e.agent_id,data:e,componentProps:{agentData:e}})}catch(e){console.error(`Error creating modal:`,e),console.error(`Error stack:`,e instanceof Error?e.stack:`No stack trace`),t.error(`打开Agent详情失败`)}},c=e=>{try{let r=n.getStepById(e);if(!r){console.error(`Step not found:`,e),t.error(`未找到步骤信息 (ID: ${e})`);return}i.createModal({type:`step`,title:`Step详情 - [${r.type}] ${r.executor}`,id:r.step_id,data:r,componentProps:{data:r}})}catch(e){console.error(`Error creating step modal:`,e),console.error(`Error stack:`,e instanceof Error?e.stack:`No stack trace`),t.error(`打开Step详情失败`)}};return y(()=>{o()}),(e,t)=>(b(),m(`div`,G,[a.value?(b(),m(`div`,K,[h(P,{type:`agent`,count:8})])):E(n).agents.length===0?(b(),m(`div`,q,[t[0]||=d(`div`,{class:`empty-icon`},`👤`,-1),t[1]||=d(`div`,{class:`empty-text`},[d(`h3`,null,`暂无Agent数据`),d(`p`,null,`当前系统中没有智能体信息，请刷新或等待Agent创建。`)],-1),d(`button`,{onClick:o,class:`refresh-button`,disabled:a.value},T(a.value?`刷新中...`:`刷新数据`),9,J)])):(b(),m(`div`,Y,[(b(!0),m(r,null,S(E(n).agents,e=>(b(),f(W,{key:e.agent_id,agent:e,onViewDetails:s,onViewStep:c},null,8,[`agent`]))),128))]))]))}}),Z=a(X,[[`__scopeId`,`data-v-0be101d4`]]);export{Z as default};